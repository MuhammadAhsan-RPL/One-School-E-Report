<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kirim Laporan ‚Äì One School E-Report</title>
  <!-- TAILWIND CDN (TANPA SPASI!) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            primary: '#0f172a',
            accent: '#0ea5e9'
          }
        }
      }
    }
  </script>
  <style>
    body { background-color: #f9fafb; }
  </style>
</head>
<body class="bg-gray-50">
  <header class="bg-white shadow-sm">
    <div class="max-w-4xl mx-auto px-4 py-4">
      <a href="index.html" class="text-xl font-bold text-primary">‚Üê Kembali ke Beranda</a>
    </div>
  </header>

  <main class="max-w-2xl mx-auto px-4 py-10">
    <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
      <div class="text-center mb-8">
        <h1 class="text-2xl font-bold text-primary">Kirim Laporan Baru</h1>
        <p class="text-slate-600 mt-2">Laporan Anda akan langsung diteruskan ke guru atau staf One School.</p>
      </div>

      <form id="reportForm" class="space-y-6">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Saya adalah</label>
          <select id="role" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
            <option>Pilih</option>
            <option>Siswa</option>
            <option>Orang Tua/Wali</option>
            <option>Guru/Staf</option>
          </select>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Nama (opsional)</label>
            <input type="text" id="name" placeholder="Contoh: Andi" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-accent">
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Kelas / Unit</label>
            <input type="text" id="class" placeholder="Contoh: Kelas 8A" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-accent">
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Kategori Laporan</label>
          <select id="category" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-accent">
            <option>Pilih kategori</option>
            <option>Fasilitas Sekolah Rusak</option>
            <option>Keluhan KBM / Guru</option>
            <option>Perilaku Tidak Tepat (Bullying, dll)</option>
            <option>Saran & Masukan</option>
            <option>Lainnya</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Isi Laporan <span class="text-red-500">*</span></label>
          <textarea id="content" rows="5" placeholder="Jelaskan secara jelas dan lengkap..." class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-accent" required></textarea>
        </div>

        <div class="flex items-start">
          <input type="checkbox" id="anonymous" class="mt-1 w-4 h-4 text-accent rounded focus:ring-accent">
          <label for="anonymous" class="ml-2 text-sm text-slate-700">Kirim secara anonim (identitas tidak dicatat)</label>
        </div>

        <button type="submit" class="w-full py-3.5 bg-accent hover:bg-sky-600 text-white font-semibold rounded-xl shadow transition">
          Kirim Laporan
        </button>
      </form>
    </div>
  </main>

  <footer class="py-6 text-center text-sm text-slate-500">
    &copy; 2025 One School E-Report. Laporan Anda dilindungi kerahasiaannya.
  </footer>

  <!-- F I R E B A S E   S D K   ( T A N P A   S P A S I ! ) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <script>
    // üîë CONFIG FIREBASE-MU (SUDAH BENAR!)
    const firebaseConfig = {
      apiKey: "AIzaSyDxWgtqspZpE-xZFVyjmZPQeAyp2gl9sl4",
      authDomain: "one-school-e-report.firebaseapp.com",
      projectId: "one-school-e-report",
      storageBucket: "one-school-e-report.firebasestorage.app",
      messagingSenderId: "533085737086",
      appId: "1:533085737086:web:3b13c6c803ba992559882f"
    };

    // üî• INISIALISASI
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // üì§ KIRIM LAPORAN
    document.getElementById("reportForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const content = document.getElementById("content").value.trim();
      if (!content) {
        alert("‚ùó Isi laporan tidak boleh kosong!");
        return;
      }

      const isAnonymous = document.getElementById("anonymous").checked;
      const report = {
        status: "Belum Ditanggapi",
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        content: content
      };

      if (!isAnonymous) {
        report.role = document.getElementById("role").value || "Tidak disebutkan";
        report.name = document.getElementById("name").value || null;
        report.class = document.getElementById("class").value || null;
        report.category = document.getElementById("category").value || "Lainnya";
      }

      db.collection("reports").add(report)
        .then(() => {
          alert("‚úÖ Laporan berhasil dikirim!\nTerima kasih!");
          document.getElementById("reportForm").reset();
          document.getElementById("anonymous").checked = false;
        })
        .catch(err => {
          console.error("Error:", err);
          alert("‚ùå Gagal mengirim. Periksa koneksi internet Anda.");
        });
    });
  </script>
</body>
</html>